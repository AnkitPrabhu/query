[
 {
        "statements": "SELECT  ARRAY_LENGTH(ARRAY director FOR director IN details.director  END) AS D FROM default:catalog WHERE POLY_LENGTH(details.director) > 1 ORDER BY D",
        "results": [
        {
            "D": null
        },
        {
            "D": 2
        }
    ]
    },
    {
      "statements": "select ARRAY_APPEND((ARRAY ol.productId FOR ol IN orderlines END), \"GreanTea\") AS A FROM default:orders ORDER BY A",
      "results": [
        {
            "A": [
                "coffee01",
                "sugar22",
                "GreanTea"
            ]
        },
        {
            "A": [
                "coffee01",
                "sugar22",
                "GreanTea"
            ]
        },
        {
            "A": [
                "coffee01",
                "tea111",
                "GreanTea"
            ]
        },
        {
            "A": [
                "tea111",
                "sugar22",
                "GreanTea"
            ]
        }
    ]
  },
  {
     "statements": "SELECT array_avg(array_agg(LENGTH(title))) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": 13.666666666666666
        }
    ]
     
  },
  {
     "description":"Object in an array hence avg returns null for each entry",
     "statements":"SELECT LENGTH(title) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": 7
        },
        {
            "$1": 18
        },
        {
            "$1": 16
        }
    ]
  },
  {
     "description":"Object in an array hence avg returns null for each entry",
     "statements":"SELECT ARRAY_AVG(LENGTH(title)) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": null
        },
        {
            "$1": null
        },
        {
            "$1": null
        }
    ]    
  },
  {
     "description":"error for array functions",
     "statements":"SELECT array_vg(LENGTH(title)) FROM default:catalog ORDER BY title",
     "error": "Invalid function array_vg.\nErrors while parsing."
  },
  {
     "statements":"select ARRAY_CONCAT((ARRAY ol.productId FOR ol IN orderlines END), [id]) AS A FROM default:orders ORDER BY A",
     "results": [
        {
            "A": [
                "coffee01",
                "sugar22",
                "1200"
            ]
        },
        {
            "A": [
                "coffee01",
                "sugar22",
                "1236"
            ]
        },
        {
            "A": [
                "coffee01",
                "tea111",
                "1234"
            ]
        },
        {
            "A": [
                "tea111",
                "sugar22",
                "1235"
            ]
        }
    ]
  },
  {
     "statements":"select ARRAY_CONCAT((ARRAY ol.productId FOR ol IN orderlines END), [id], [\"GreanTea\"]) AS A FROM default:orders ORDER BY A",
     "error":"Wrong number of arguments to function ARRAY_CONCAT."
  },
  {
     "statements":"SELECT ARRAY_CONTAINS(array_agg(LENGTH(title)), 7) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": true
        }
    ]
  },
  {
     "statements":"SELECT ARRAY_COUNT(array_agg(LENGTH(title))) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": 3
        }
    ]
  },
  {
    "description":"Output before Distinct",
    "statements":"SELECT array_concat(array_agg(LENGTH(title)),[16,18,54]) FROM default:catalog ORDER BY title",
     "results": [
        {
            "$1": [
                7,
                16,
                18,
                16,
                18,
                54
            ]
        }
    ]
  },
 {
   "description":"Distinct gives inconsistent results, hence sort",
   "statements":"SELECT array_sort(array_distinct(array_concat(array_agg(LENGTH(title)),[16,18,54]))) FROM default:catalog ORDER BY title",
   "results": [
        {
            "$1": [
                7,
                16,
                18,
                54
            ]
        }
    ] 
 },
 {
   "description":"Output before Distinct",
   "statements":"select array_sort(ARRAY_CONCAT((ARRAY ol.productId FOR ol IN orderlines END), [\"coffee01\"])) AS A FROM default:orders ORDER BY A ",
   "results": [
        {
            "A": [
                "coffee01",
                "coffee01",
                "sugar22"
            ]
        },
        {
            "A": [
                "coffee01",
                "coffee01",
                "sugar22"
            ]
        },
        {
            "A": [
                "coffee01",
                "coffee01",
                "tea111"
            ]
        },
        {
            "A": [
                "coffee01",
                "sugar22",
                "tea111"
            ]
        }
    ]
 },
 { 
   "description":"Distinct gives inconsistent results, hence sort",
   "statements":" select array_sort(ARRAY_DISTINCT(ARRAY_CONCAT((ARRAY ol.productId FOR ol IN orderlines END), [\"coffee01\"]))) AS A FROM default:orders ORDER BY A ",
   "results": [
        {
            "A": [
                "coffee01",
                "sugar22"
            ]
        },
        {
            "A": [
                "coffee01",
                "sugar22"
            ]
        },
        {
            "A": [
                "coffee01",
                "sugar22",
                "tea111"
            ]
        },
        {
            "A": [
                "coffee01",
                "tea111"
            ]
        }
    ]
 },
 {
   "description":"If prev example is an array of slices then the result is as follows.",
   "statements":"select array_sort(ARRAY_DISTINCT(array_agg(ARRAY ol.productId FOR ol IN orderlines END) ) ) AS A FROM default:orders ORDER BY A",
   "results": [
        {
            "A": [
                [
                    "coffee01",
                    "sugar22"
                ],
                [
                    "coffee01",
                    "tea111"
                ],
                [
                    "tea111",
                    "sugar22"
                ]
            ]
        }
    ]
 },
 {
     "statements":"select ARRAY_IFNULL([null, null, null, \"append\", \"avg\", null, \"max\"])",
     "results": [
        {
            "$1": "append"
        }
    ]
  },
  {
     "statements":"select ARRAY_LENGTH([null, null, null, \"append\", \"avg\", null, \"max\"])",
     "results": [
        {
            "$1": 7
        }
    ]
  }
]


